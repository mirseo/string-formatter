# Mirseo Formatter 모드 가이드

`mirseo-formatter`는 다양한 운영 환경과 목적에 맞춰 세 가지 분석 모드를 제공합니다. 각 모드는 성능과 기능에 있어 뚜렷한 차이를 가지므로, 사용자의 서비스 요구사항에 가장 적합한 모드를 선택하는 것이 중요합니다.

---

## IDS (Intrusion Detection System)

IDS 모드는 탐지 및 경고에 초점을 맞춥니다. 입력된 텍스트에서 잠재적인 위협을 식별하고 점수를 부여하지만, 원본 텍스트를 변경하거나 차단하지는 않습니다.

### 주요 특징
- **목적**: 공격 시도를 기록하고 모니터링
- **작동 방식**: 위협을 감지하면 경고 로그를 남기거나 알림을 발생

### 추천 사용 사례
- 서비스에 새로운 보안 규칙을 도입하기 전에 실제 위협이 얼마나 발생하는지 파악하기 위한 모니터링 단계
- 사용자의 입력이 직접적으로 시스템에 큰 영향을 미치지 않는 저위험 환경

---

## IPS (Intrusion Prevention System)

IPS 모드는 즉각적인 방어 및 완화에 초점을 맞춥니다. 위협이 탐지되면, 정의된 임계값(기본값 0.55)을 초과하는 경우 원본 텍스트를 안전한 메시지로 대체하거나 차단합니다.

### 주요 특징
- **목적**: 프롬프트 인젝션 공격을 사전에 차단하여 모델과 시스템을 보호
- **작동 방식**: 위험도가 높은 입력이 들어오면, "계속 진행하세요"와 같은 안전한 응답 텍스트를 반환
- **임계값**: 기본값 0.55 (설정 가능)

### 추천 사용 사례
- 사용자 입력이 AI 모델의 민감한 기능에 접근할 수 있는 고위험 환경
- 실시간 API 서비스에서 예측 가능한 성능과 안정성을 확보하려는 경우

---

## IUS (Intrusion Ultimate System)

IUS 모드는 성능 및 효율성 극대화를 위해 설계된 고급 모드입니다. 멀티코어 병렬 처리와 강력한 캐싱 시스템을 결합하여 분석 속도를 획기적으로 향상시킵니다.

### 주요 특징
- **목적**: 대규모 데이터 처리 및 반복적인 위협에 대한 분석 성능을 최적화

### 핵심 기술

#### 캐싱 시스템
- 분석 결과를 메모리에 캐시하여 동일한 입력에 대한 반복적인 분석을 생략
- 봇 공격처럼 유사한 패턴이 반복되는 환경에서 특히 효과적

#### 병렬 처리
- `rayon` 라이브러리를 사용하여 여러 개의 입력 문자열을 여러 CPU 코어에서 동시에 분석

### 추천 사용 사례
- AI 모델 학습 전 데이터셋 필터링 및 정제
- 대량의 프롬프트를 한 번에 분석해야 하는 오프라인 배치 작업
- 동일하거나 유사한 봇 공격이 빈번한 고트래픽 서비스

> **참고**: IUS 모드는 Node.js 환경보다는 Python 환경에 더 최적화되어 있습니다.

---

## 모드 비교

| 특징 | IDS | IPS | IUS |
|------|-----|-----|-----|
| **주요 기능** | 탐지 및 모니터링 | 즉시 차단 및 방어 | 고성능 처리 |
| **성능** | ✅ 표준 | ✅ 표준 | ⭐ 최고 |
| **스레드** | 싱글 스레드 | 싱글 스레드 | ✅ 멀티스레드 |
| **실시간 처리** | ✅ | ✅ | ✅ |
| **배치 처리** | ⚠️ 제한적 | ⚠️ 제한적 | ✅ 최적화됨 |
| **캐싱** | ❌ | ❌ | ✅ |
| **병렬 처리** | ❌ | ❌ | ✅ |
| **적용 환경** | 저위험-중위험 | 중위험-고위험 | 모든 환경 |

---

## 모드 선택 가이드

### 일반적인 권장사항
대부분의 실시간 API 서비스에서는 IPS 모드를 사용해 즉각적인 방어를 구현하는 것을 권장합니다.

### 분석 및 모니터링 목적
시스템에 영향을 주지 않고 위협 동향을 파악하고 싶다면 IDS 모드를 활용하세요.

### 고성능이 필요한 경우
대규모 데이터셋 처리나 반복적인 공격에 대비해야 한다면 IUS 모드가 최상의 효율을 제공합니다.

---

## 사용 예제

```python
import mirseo_formatter as mf

# IDS 모드 - 모니터링
result_ids = mf.analyze(prompt, lang='ko', mode='ids')

# IPS 모드 - 실시간 방어 (권장)
result_ips = mf.analyze(prompt, lang='ko', mode='ips') 

# IUS 모드 - 고성능 처리
result_ius = mf.analyze(prompt, lang='ko', mode='ius')
```